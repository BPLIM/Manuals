---
title: Guide for Researchers
author: Banco de Portugal's Microdata Research Laboratory (BPLIM)
date: "June 27, 2024"
logo: logo.png
format: 
    html:
        cover-image: logo.png
        theme: cosmo
        toc: true
        toc-title: Contents
        number-sections: true
        fontfamily: libertinus
---

{{< pagebreak >}}

# General Remarks

The Banco de Portugal Microdata Research Laboratory (BPLIM) is part of the Economics and Research Department of Banco de Portugal (BdP) and was created with the objective of facilitating to researchers the access and use of micro datasets about the Portuguese economy. Primarily, these are datasets owned by BdP, but there are other datasets supplied by third parties. Data can only be accessed on BPLIM's **external** server or in the internal infrastructure of the bank. The **external server** has remote access capabilities and is intended for use by external researchers. Internal researchers (those with a contractual link to BdP) have access to a scalable computational platform (**Pit√°goras**) and to a data repository created by BPLIM which can be used without restrictions.

# Data Available for Researchers

## What are the characteristics of BPLIM's datasets?

All BPLIM datasets created for research purposes are stripped of elements that allow for direct identification of companies, banks, or individuals. Whenever possible, the datasets contain unique unit identifiers common across datasets: examples of these are *tina* -- the tax identification number anonymized for companies -- and *bina* -- the bank identification number anonymized. 
Data are stored in an efficient way that minimizes file size and follow BPLIM's naming convention. Labels are applied to all variables and value labels to all categorical variables. Whenever possible labels can be displayed in Portuguese and English and datasets are accompanied by a manual that contains all relevant information regarding the data. An auxiliary file with the metadata and descriptive statistics is provided for each data file. By default datasets are made available in *Stata* format. Larger datasets may be made available in *parquet* format. BPLIM datasets may also have companion script files which calculate additional variables or harmonized variables that guarantee comparability over time and across datasets. Datasets are updated regularly based on a data extraction ("data freeze") at a specific point in time and a versioning system is applied to reflect any changes to the data set. Most datasets have an associated Digital Object Identifier (DOI).

## What data are available?

The complete list of datasets including a short description is available in [BPLIM's Datasets]. In BPLIM's [website](https://www.bplim.bportugal.pt) you can find a list of the latest version of datasets available for external researchers along with a link to the data manuals.[^1] A metafile containing descriptive statistics for each dataset can be obtained once you are given access to the server. See the External server manual [add link].

[^1]: The Data Manuals are available on [GitHub](https://github.com/BPLIM/Manuals).

# Data Access

## Who can gain access to the data?

Access is only allowed to researchers who intend to use the data for scientific purposes. Internal users have access to all datasets available at BPLIM. Access by external researchers is subject to several restrictions. [BPLIM's Datasets] summarizes the access restrictions for each dataset.

## How can researchers request access to the data?

Internal researchers are given access to a data repository maintained by BPLIM which can be used unreservedly for research and policy activities without any formality. However, if they are working with external co-authors or if they need to use or link other micro datasets not available in the repository they will need to submit a project to BPLIM. External researchers must always submit a project. 
The project proposal must: (1) contain a short description of the research project; (2) identify all researchers involved in the project and their affiliations; and (3) identify the datasets, timeframe, and variables required. All external researchers with access to the data are required to sign a confidentiality agreement and send a copy of their vitas. A copy of the required documents can be found in BPLIM's website [add link]. If the project consists of a master or doctoral dissertation then the supervisor(s) has to be identified and must also sign the confidentiality agreement. BPLIM staff will work with the researcher(s) to identify the required datasets and, if needed, to build a customized dataset.

## Approval process

Upon submission of all documentation the project will be evaluated to ensure that it addresses a legitimate research question. Compliance with the guidelines is also an important factor for recurring external researchers (those that have already participated in BPLIM projects). Once the project is approved data access will be granted and summary information about the project will be posted on BPLIM's website [Joana: is this disclosed in the form they sign?].

## How can the data be accessed?

When applying for the project the researcher must specify if he/she plans to access an internal account (**Pitagoras**) or an account in the **external server**. Accounts open at **Pitagoras** can only be accessed at the installations of BdP ("on-site access") either at Lisbon or Porto. BdP internal researchers can login into **Pitagoras** from their terminal using their network login credentials. Users not affiliated to BdP are considered external researchers. They will be assigned a login and password for **Pitagoras** and will be granted access to a terminal from which it is not technically possible to transfer, download, copy, paste, or print any data. For more details on accessing BPLIM accounts in **Pitagoras** see [add reference]. 
There is a limited number of terminals available so external researchers must book their visits well in advance.

If the account is on the **external server** then the data has be accessed remotely ("remote access") using a safe connection (we use the [*nomachine*](https://www.nomachine.com/) software). With this connection it is not possible to exchange files between the external server and the local computer. For more details on using the external server see the External Server Manual[add reference].

In special circumstances explained below the external researcher may be granted indirect access to the data ("surrogate access", a.k.a, "remote execution"). With surrogate access there is no need for the external researcher to have an account, as  BPLIM staff (or an internal researcher) will act as a proxy regarding data access. This means that BPLIM staff (or an internal researcher) will execute the scripts written by the external researcher and share the outputs after validation.

## What are the restrictions imposed on access to BPLIM's datasets?

Internal researchers are able to access all datasets available at BPLIM in an anonymized format. However, they will have the same access conditions as external researchers if accessing data through the external server.
The access policy for an external researcher is more restrictive. External researchers are granted access to a subset of all datasets available at BPLIM (for a list of the available datasets see xxxx).  Datasets made available to external researchers are subject to a confidentiality classification as follows: **low**, **medium**, or **high**. If the data are classified as **low** then the data is only anonymized. However, if a dataset is classified as **medium** then the dataset will contain variables with "modified" values, not their original values. Datasets classified with a **high** level of confidentiality contain variables with "modified" values and are restricted to a subsample of the observations. The external researcher can always request to have his/her scripts ran on the original datasets. This rule applies whether the access is "on-site" or "remote". 

However, if working in a joint project with an internal researcher, external researchers may have access to additional research datasets. In this case, access by the external researcher is always in surrogate mode. His/her internal co-author will have access to an anonymized version of the data which will be placed in a "Pitagoras" account. 

In very particular situations, it may be possible for an external researcher to gain surrogate access to a dataset, without an internal co-author. Further information can be found below.

## How are projects that involve co-authorship between BdP internal researchers and external researchers handled?

In joint projects where the external researcher does not have access to the original data the internal researcher has the responsibility to ensure that the information shared with his/her external co-authors respects the confidentiality requirements associated with the data.

Projects where internal and external researchers have access to the data are designated "mixed projects". If the mixed project is implemented in the external server then the distinction is irrelevant as all researchers are treated as external. However, if the project is in **Pitagoras**, BPLIM will open an account for the BdP internal researcher(s) and place all the requested data there. 

External co-authors can be added as users if the datasets made available in that account have a confidentiality classification of "low". If the account contains datasets with a higher classification level, then the internal user may request the creation of a second "parallel" account. This second account will have both the internal and external researchers as users but the data available will respect the requirements imposed on access for external researchers. It will be the responsibility of the internal researcher to run all scripts on the original data placed on the first account that only he/she has access to. It will also be his/her responsibility to make sure that external researchers do not have any type of access to confidential data; in particular, external co-authors cannot access the project account with the original data, the desktop computer of the internal co-author, or any logs that might contain confidential data. In a mixed project all interaction with BPLIM should be done via the BdP internal researcher. Finally, "mixed projects" can also be implemented in *surrogate mode*.

## How can an external researcher gain surrogate access to a dataset?

There are two types of datasets that can only be accessed in surrogate mode: 1) BdP datasets with exposure or individual level information and 2) confidential third-party datasets available for internal projects that contemplate the possibility of external co-authors. See the [List of Datasets].
In case 1) the external researcher needs to submit a detailed project to BPLIM. The project will be evaluated **according to the relevance of the topic** for the research agenda of BdP. Only projects deemed relevant will be granted surrogate access. If BPLIM decides to support the project then the external researcher will be assigned a data expert at the microdata laboratory (BPLIM) who will interact with him/her and will help prepare and run the scripts on the original data. However, coding is the ultimate responsibility of the researcher and BPLIM will not validate or certify the scripts written by the researcher. External researchers should work in close cooperation with BPLIM staff to ensure that they are obtaining the envisioned results and are encouraged to discuss their findings with BPLIM staff. It is highly recommended that external researchers initiate their project with a short-stay visit in BPLIM. During that time they are expected to discuss their research with BPLIM staff and to gain a good understanding of the complexities of the data. Other visits, during the course of the project, are also encouraged. All outputs shared with the external researcher are subject to the usual disclosure restrictions. Access conditions for external researchers may be waived if they are already familiar with the data.
If the external researcher has an internal co-author then he/she can gain surrogate access to both types of datasets. In this case, the internal researcher will play the role of BPLIM staff. It is up to the internal researcher to run the scripts on the original data and to control all the information that is shared with his/her external co-authors. If needed, BPLIM will assist internal co-authors in this process.

## How can external researchers work with modified data?

Datasets that have a confidentiality classification of "medium" or "high" are available in a "modified" version. These datasets are made available to facilitate the elaboration of the scripts that manipulate/analyze the data. However, results of analysis performed on datasets with modified variables [are not valid for research purposes]{.underline}. Once external researchers finalize their code they can always request that the scripts be ran on the original data.

BPLIM can use three different strategies to create modified datasets: [perturbed]{.underline}, [shuffled]{.underline}, or [randomized]{.underline}. A **perturbed** **dataset** is a dataset that contains "perturbed" variables which are variables where the original values have been replaced by different values which are correlated with the original values. A perturbed file is easily identified because the file name will contain "\_P\_". When variables are perturbed variable is also clearly identified . A **shuffled** **dataset** contains "shuffled" variables, that is, variables that keep their original values but have been sorted randomly and independently of the rest of the dataset to break the link for the observations. Similar to perturbed variables the file name will contain "\_S\_" and the variable names will end in "\_s". Finally, a **randomized** **dataset** is a dataset that is both perturbed and shuffled. Randomized variable names end in "\_r" and the file name contains "\_R\_".[^3]

[^3]: Appendix B provides advices for researchers working with modified datasets.

If the project involves a co-authorship with internal researchers at the bank ("mixed project") then the responsibility of running the scripts on the original data falls upon the internal researcher since he/she has access to the original data. If the project does not involve internal researchers then BPLIM staff will run the scripts on the original data. This is a process that takes time as we first need to replicate the results with the modified data before moving on to the original data. To speed up the process researchers working with modified data are encouraged to follow the basic rules outlined in Appendix B. In case of any doubts regarding this process, external researchers should contact BPLIM staff directly before writing any script.

## Transfer of external files

BdP internal researchers working in **Pitagoras** can freely copy files to and from their account in the internal server and thus are free to merge BPLIM datasets with other data. BPLIM will assist with the anonymization of external datasets to ensure compatibility among datasets. Note that BPLIM identifiers (eg: *tina* and *bina*) are specific to a project and may not be valid if files are exchanged between accounts. If the account is shared with external researchers ("mixed project") then the internal researcher has to respect the guidelines that apply to external researchers. At the request of the internal researcher BPLIM can anonymize and/or modify the external datasets intended to be used in mixed projects.

External researchers may also request that external files are placed on their accounts. The origin of these files must be clearly explained and a justification for their use must be provided. The researcher should also make sure these files can be legitimately used for that purpose. BPLIM staff will assist with the merging of the external datasets with BPLIM datasets. External datasets typically contain aggregated data but it may be possible to add external datasets with finer granularity. In this latter case additional measures may have to be undertaken to ensure that the confidentiality of the data is preserved. These situations will be analyzed case by case and discussed with BPLIM staff.

# Statistical Software

## Statistical Software

Once the account for the project is created the researcher(s) will have access to a Linux environment that has Stata, *R*, and *Julia* available. Templates for writing code are also placed in the account and researchers should, as much as possible, adhere to the conventions described on the templates. A number of packages that extend the capabilities of the base distributions have been pre-installed. BPLIM staff will assist if the researcher needs any additional package. Installed packages will be placed in the "tools" folder of the project and are available only for that specific project.

## Additional Tools

BPLIM staff has created several tools (Stata packages) to facilitate the tasks of the researcher. Some of these tools are specific to BPLIM datasets while others are of general utility. All of these tools are available on BPLIM's servers. Because we want to be transparent about the coding and versioning we make all tools also available on [Github](https://github.com/BPLIM/Tools). Users are welcome to suggest improvements or add their own contributions. Tools which are of generic use can be installed directly from Github on any internet connected machine.

# Output Extraction

## Can the researcher transfer any files from the server?

External researchers are **never allowed to transfer files to/from BPLIM's servers**. The same policy applies to BdP internal researchers working on the external server.

However, BdP internal researchers are free to transfer files to and from their accounts in the BPLIM internal server. When an account is created for an internal researcher in the internal server the project area from the internal server is mapped to the researcher's personal desktop. This means that internal researchers can easily transfer files to and from BPLIM's internal server including data and output logs. In case the internal researcher is working with external co-authors it will be his/her responsibility to ensure that all files shared with the external co-authors respect the guidelines imposed for the release of information.

## What restrictions apply to the release of output logs?

As a general principle BPLIM will never check for the "correctness" of the scripts that researchers use to produce the logs and declines any responsibility for any errors or imprecisions that are present in researcher's code. This is the sole responsibility of the researcher. Output logs should never contain information that reveals individual records of the dataset, and thus should only contain aggregate-level information. This means that listings of individual records, tables with cells with values obtained from manipulation of three or less observations, statistical measures with standard errors of zero, minimum and maximum values, etc., are not allowed. Plain text files (including Latex and comma or tab separated values) are the preferable format but other formats may be accepted provided that data content can be easily checked (e.g. small Excel files). Graphical outputs should be produced in the ".png" format. In mixed projects the responsibility of checking adherence to these principles falls upon the internal researcher. If requested by the internal researcher, BPLIM will assist with that process. In projects involving only external researchers, it will be the responsibility of BPLIM staff to verify conformability of all outputs. Output verification depends on staff availability and may take longer in periods when the workload is higher. BPLIM staff will only answer requests for output extraction sent by email and will take as long as needed to ensure that all confidentiality requirements are safeguarded. Researchers should keep their output requests to a minimum and, as much as possible, these should be of final outputs. In the case where researchers are working with modified datasets (eg: perturbed files) and want to look at intermediary results obtained from original datasets it may be possible to place the logs in a folder in the researcher's account instead of emailing the results.

## What happens if the researcher violates the rules?

BPLIM assumes that all researchers are operating in good will and they should strive to follow the dispositions set forth on the signed "Declaration on Confidentiality and Use of Data". If a researcher behaves in a way that is considered inappropriate BPLIM reserves the right to cancel all projects in which the researcher is involved.

# Replicability and Data Archiving

## Replicability of work

BPLIM will work with third-parties such as data editors, certification services, or individual researchers to provide conditions for replication of results for individual projects. The replication process consists of opening an account for the "replicator" and providing him with the same BPLIM datasets of the project. Additional files from the project may be provided if there is a request for their archival (see below). To facilitate replication researchers should unequivocally identify all datasets used in the analysis. All other needed files should be provided by the "replicator". BPLIM will work directly with data editors or certification services (e.g. Cascad) to evaluate the best approach to implement their replication protocol. In the case of individual researchers willing to act as "replicators" they will have to go through the standard process of submitting a research project.

## Archiving

By default, once a project is closed BPLIM will keep a copy of all syntax files (e.g. text files with "do", "R", and "jl" extensions) plus all files found in the "*initial_dataset*" and the "*tools*" folder. A copy of the syntax files will be sent to the researcher who should verify that the list is complete. All other files will be deleted unless the researcher explicitly requests that certain external file(s) (see subsection 3.9) are archived. Only in exceptional and well justified circumstances will BPLIM agree to archive intermediate data files created by the researchers. It is the responsibility of the researcher to ensure that all files needed for proper replication of the results are archived with the project. Archives are kept for ten years since the closing of the project.

# Publication of Research Papers

## Citations and research outputs

All BPLIM datasets should be cited according to the information provided in the data manual. If available, the Digital Object Identifier (DOI) should be referenced. When the topic analyzed by the external researcher(s) bears special relationship to BdP's statutory tasks the researcher is encouraged to discuss their results with BdP staff. In this case, BdP may ask to see a copy of the work prior to any public release and may provide suggestions regarding the research project. Moreover, in situations where data access is granted based on the relevance of the topic ("surrogate access") researchers are not only encouraged to discuss their results with BdP staff but must also seek BdP approval prior to any public release of their results. As soon as available, researchers are required to send to BPLIM a copy of all research outputs (working paper, conference proceedings, paper, thesis, etc.) related to the project.

# Contacting BPLIM

## How can I contact BPLIM?

The preferred way to contact BPLIM is through email: [BPLIM\@bportugal.pt](mailto:bplim@bportugal.pt). <br> For projects already ongoing the subject line should always include the project reference (eg: p###\_Surname). If necessary you can contact us at:

**Address:** <br>

Banco de Portugal <br>

Microdata Research Laboratory <br>

Rua do Almada, 71 <br>

4050-036 Porto <br>

Portugal


